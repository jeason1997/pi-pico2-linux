.syntax unified

/* Minimum image def
 * See 5.9.5. Minimum Viable Image Metadata
 * in rp2350 datasheet.
 */

#define PICOBIN_BLOCK_MARKER_START		0xffffded3
#define PICOBIN_BLOCK_MARKER_END		0xab123579
#define PICOBIN_BLOCK_ITEM_2BS_LAST		0xff
#define PICOBIN_BLOCK_ITEM_LOOP			0x00000000

#define PICOBIN_BLOCK_ITEM_1BS_IMAGE_TYPE	0x42

#define PICOBIN_IMAGE_TYPE_IMAGE_TYPE_AS_BITS_EXE	0x01
#define PICOBIN_IMAGE_TYPE_EXE_SECURITY_AS_BITS_NS	0x10
#define PICOBIN_IMAGE_TYPE_EXE_SECURITY_AS_BITS_S	0x20
#define PICOBIN_IMAGE_TYPE_EXE_CPU_AS_BITS_ARM		0x000
#define PICOBIN_IMAGE_TYPE_EXE_CPU_AS_BITS_RISCV	0x100
#define PICOBIN_IMAGE_TYPE_EXE_CHIP_AS_BITS_RP2350	0x1000

#define PICOBIN_BYTE_PAD	0x00

.section .image_header, "ax"
__image_header:
.word PICOBIN_BLOCK_MARKER_START

.byte PICOBIN_BLOCK_ITEM_1BS_IMAGE_TYPE
.byte 0x01 // (This item is 1 word in size)
.hword (PICOBIN_IMAGE_TYPE_IMAGE_TYPE_AS_BITS_EXE | \
	PICOBIN_IMAGE_TYPE_EXE_CHIP_AS_BITS_RP2350 | \
	PICOBIN_IMAGE_TYPE_EXE_SECURITY_AS_BITS_S | \
	PICOBIN_IMAGE_TYPE_EXE_CPU_AS_BITS_ARM)

.byte PICOBIN_BLOCK_ITEM_2BS_LAST
.hword 0x0001 // (Sum of all items' sizes in words.) Only one item with size of 1 word
.byte PICOBIN_BYTE_PAD

.word PICOBIN_BLOCK_ITEM_LOOP

.word PICOBIN_BLOCK_MARKER_END
